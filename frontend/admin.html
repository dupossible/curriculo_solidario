<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin — Currículo Solidário</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="styles.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
<nav class="navbar navbar-light bg-white border-bottom px-3">
  <span class="navbar-brand mb-0 h1 text-primary">Painel da Gráfica</span>
  <button id="logout" class="btn btn-outline-secondary btn-sm">Sair</button>
</nav>
<div class="container py-4">
  <div class="input-group mb-3">
    <input id="searchCode" class="form-control" placeholder="Digite o código de impressão">
    <button id="btnFind" class="btn btn-primary">Buscar</button>
  </div>
  <div id="result"></div>
</div>
<script>
const API = "http://127.0.0.1:5000";
document.getElementById('logout').onclick=()=>{ window.location.href='login-admin.html'; };
document.getElementById('btnFind').onclick = async ()=>{
  const code = document.getElementById('searchCode').value.trim();
  if (!code) return;
  const r = await fetch(`${API}/api/cv/by-code/${code}`);
  const data = await r.json();
  if (!data.ok) { Swal.fire('Não encontrado','','warning'); return; }
  const cv = data.cv;
  document.getElementById('result').innerHTML = `
    <div class="card card-elev p-3">
      <div><strong>Nome:</strong> ${cv.name}</div>
      <div><strong>E-mail:</strong> ${cv.email}</div>
      <div><strong>Telefone:</strong> ${cv.phone}</div>
      <div class="mt-2">
        <a href="${API}/api/cv/${cv.printCode}/pdf" target="_blank" class="btn btn-success">Baixar PDF</a>
      </div>
    </div>
  `;
};
</script>
</body>
</html>
